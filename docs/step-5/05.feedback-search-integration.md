# ν”Όλ“λ°± λ£¨ν”„ μ•„ν‚¤ν…μ²

## κ°μ”

ν”Όλ“λ°± μμ§‘λ¶€ν„° AI κ°μ„ κΉμ§€μ μ „μ²΄ λ£¨ν”„λ¥Ό μ„¤κ³„ν•κ³  κµ¬ν„ν•©λ‹λ‹¤.

## ν•™μµ λ©ν‘

- ν”Όλ“λ°± λ£¨ν”„ μ•„ν‚¤ν…μ² μ΄ν•΄
- μμ§‘ β†’ λ¶„μ„ β†’ κ°μ„ μ μ „μ²΄ μ‚¬μ΄ν΄ μ²΄ν—
- AI μ‹μ¤ν… μ§€μ†μ  κ°μ„  λ°©λ²• ν•™μµ
- λ°μ΄ν„° κΈ°λ° μμ‚¬κ²°μ • ν”„λ΅μ„Έμ¤ μµλ“

---

```
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚                    μ‚¬μ©μ                                β”‚
β”‚  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”                                          β”‚
β”‚  β”‚ κ²€μƒ‰ μ”μ²­ β”‚                                          β”‚
β”‚  β””β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”                                          β”‚
β”‚        β”‚                                                β”‚
β”‚        β–Ό                                                β”‚
β”‚  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”      β”‚
β”‚  β”‚        κ²€μƒ‰ κ²°κ³Ό + Inline Keyboard            β”‚      β”‚
β”‚  β”‚  [λ„μ„ λ©λ΅]                                  β”‚      β”‚
β”‚  β”‚  [π‘ λ„μ›€μ΄ λ¨] [π‘ λ„μ›€μ΄ μ•λ¨]              β”‚      β”‚
β”‚  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”      β”‚
β”‚                  β”‚                                      β”‚
β”‚                  β–Ό                                      β”‚
β”‚  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”      β”‚
β”‚  β”‚           λ²„νΌ ν΄λ¦­ (ν”Όλ“λ°±)                  β”‚      β”‚
β”‚  β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”      β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
                   β”‚
                   β–Ό
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚              ν”Όλ“λ°± λ°μ΄ν„° μμ§‘                          β”‚
β”‚  CallbackQueryHandler β†’ FeedbackService β†’ Repository    β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
                           β”‚
                           β–Ό
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚                 ν”Όλ“λ°± λ¶„μ„                             β”‚
β”‚  β€Ά κΈμ •/λ¶€μ • λΉ„μ¨ κ³„μ‚°  β€Ά κ²€μƒ‰μ–΄λ³„ ν’μ§ λ¶„μ„            β”‚
β”‚  β€Ά μ‚¬μ©μλ³„ μ„ νΈλ„ λ¶„μ„                                 β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
                           β”‚
           β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
           β”‚               β”‚               β”‚
           β–Ό               β–Ό               β–Ό
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”  β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚  μ¬μ •λ ¬      β”‚  β”‚  κ°μΈν™”      β”‚  β”‚  ν”„λ΅¬ν”„νΈ    β”‚
β”‚  (Ranking)   β”‚  β”‚  (Personal)  β”‚  β”‚  κ°μ„        β”‚
β”‚              β”‚  β”‚              β”‚  β”‚              β”‚
β”‚ [κΈμ • ν”Όλ“λ°± β”‚  β”‚ [μ‚¬μ©μκ°€    β”‚  β”‚ [ν†µκ³„λ¥Ό LLM  β”‚
β”‚  λ§μ€ λ„μ„   β”‚  β”‚  μΆ‹μ•„ν•λ”    β”‚  β”‚  μ— μ „λ‹¬]    β”‚
β”‚  μƒμ„ ν‘μ‹]  β”‚  β”‚  λ„μ„ μ¶”μ²]  β”‚  β”‚              β”‚
β””β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”€β”  β””β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”€β”  β””β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”€β”
       β”‚                 β”‚                 β”‚
       β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”Όβ”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
                         β”‚
                         β–Ό
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚               κ°μ„ λ κ²€μƒ‰ κ²°κ³Ό                           β”‚
β”‚  β€Ά λ” κ΄€λ ¨μ„± λ†’μ€ λ„μ„  β€Ά κ°μΈν™”λ μ¶”μ²                 β”‚
β”‚  β€Ά λ” μ •ν™•ν• AI μ¶”μ² μ‚¬μ                                β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¬β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
                           β”‚
                           β–Ό
                    β”β”€β”€β”€β”€β”€β”€β”΄β”€β”€β”€β”€β”€β”€β”
                    β”‚   μ‚¬μ©μ     β”‚ (λ£¨ν”„ κ³„μ†)
                    β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
```

---

## κµ¬ν„ λ‹¨κ³„

### Phase 1: λ°μ΄ν„° κ³„μΈµ (1μ‹κ°„)

- [x] SearchFeedback Entity μ‘μ„±
- [x] SearchFeedbackRepository μΈν„°νμ΄μ¤ μ •μ
- [x] DDLλ΅ ν…μ΄λΈ” μƒμ„± ν™•μΈ

**ν•™μµ ν¬μΈνΈ:**
- JPA μ–΄λ…Έν…μ΄μ… (@Entity, @Table, @Index)
- Enum μ²λ¦¬ (@Enumerated)
- μƒλ…μ£ΌκΈ° μ½λ°± (@PrePersist)

---

### Phase 2: λΉ„μ¦λ‹μ¤ κ³„μΈµ (1μ‹κ°„)

- [x] FeedbackRequest, FeedbackStats DTO μ‘μ„±
- [x] FeedbackService μΈν„°νμ΄μ¤ μ„¤κ³„
- [x] FeedbackServiceImpl κµ¬ν„

**ν•™μµ ν¬μΈνΈ:**
- record ν™μ©
- Validation μ–΄λ…Έν…μ΄μ…
- @Transactional νΈλμ­μ… κ΄€λ¦¬

---

### Phase 3: UI κ³„μΈµ (1.5μ‹κ°„) β…

- [x] TelegramKeyboardFactory μ‘μ„±
- [x] CallbackQueryHandler μ‘μ„±
- [x] LibraryTelegramBot μμ •

**ν•™μµ ν¬μΈνΈ:**
- Inline Keyboard κµ¬μ΅°
- Callback λ°μ΄ν„° νμ‹±
- AnswerCallbackQuery ν™μ©

---

### Phase 4: κ΄€λ¦¬μ API (30λ¶„) β…

- [x] FeedbackAdminController μ‘μ„±
- [x] API ν…μ¤νΈ (FeedbackAdminControllerTest)
- [x] Telegram Bot λ…λ Ήμ–΄ ν™•μ¥ (/stats, /mystats)

**REST API μ—”λ“ν¬μΈνΈ:**
- `GET /api/admin/feedback/book/{bookId}/stats` - λ„μ„λ³„ ν”Όλ“λ°± ν†µκ³„
- `GET /api/admin/feedback/stats?query=xxx` - κ²€μƒ‰μ–΄λ³„ ν”Όλ“λ°± ν†µκ³„
- `GET /api/admin/feedback/recent?days=7` - μµκ·Ό ν”Όλ“λ°± λ©λ΅
- `GET /api/admin/feedback/user/{chatId}` - μ‚¬μ©μλ³„ ν”Όλ“λ°± λ©λ΅

**Telegram Bot λ…λ Ήμ–΄:**
- `/stats <κ²€μƒ‰μ–΄>` - κ²€μƒ‰μ–΄λ³„ ν”Όλ“λ°± ν†µκ³„ μ΅°ν
- `/mystats` - λ‚΄ ν”Όλ“λ°± λ‚΄μ—­ μ΅°ν

**ν•™μµ ν¬μΈνΈ:**
- REST API μ„¤κ³„
- @RequestParam, @PathVariable
- ResponseEntityλ΅ JSON μ‘λ‹µ

---

---

## ν¨ν‚¤μ§€ κµ¬μ΅°

```
src/main/java/com/.../telegram/
β”β”€β”€ entity/
β”‚   β””β”€β”€ SearchFeedback.java
β”β”€β”€ repository/
β”‚   β””β”€β”€ SearchFeedbackRepository.java
β”β”€β”€ dto/
β”‚   β”β”€β”€ FeedbackRequest.java
β”‚   β””β”€β”€ FeedbackStats.java
β”β”€β”€ service/
β”‚   β”β”€β”€ FeedbackService.java
β”‚   β””β”€β”€ FeedbackServiceImpl.java
β”β”€β”€ keyboard/
β”‚   β””β”€β”€ TelegramKeyboardFactory.java
β”β”€β”€ handler/
β”‚   β””β”€β”€ CallbackQueryHandler.java
β””β”€β”€ api/
    β””β”€β”€ FeedbackAdminController.java
```

---

## μ‚¬μ© μμ‹

### 1. ν”Όλ“λ°± μ”μ²­

```
User: ν•΄λ¦¬ν¬ν„°

Bot: π“ "ν•΄λ¦¬ν¬ν„°" κ²€μƒ‰ κ²°κ³Ό

     π¤– AI μ¶”μ² μ‚¬μ 
     π’¬ ν•΄λ¦¬ν¬ν„° μ‹λ¦¬μ¦μ μ²« λ²μ§Έ μ±…μΌλ΅...

     κ²€μƒ‰λ λ„μ„ (3κ°)

     π’΅ κ²€μƒ‰ κ²°κ³Όκ°€ λ„μ›€μ΄ λμ…¨λ‚μ”?
     μ•„λ λ²„νΌμΌλ΅ ν”Όλ“λ°±μ„ μ£Όμ‹λ©΄ κ²€μƒ‰ ν’μ§ κ°μ„ μ— μ°Έκ³ ν•κ² μµλ‹λ‹¤!

     1. ν•΄λ¦¬ν¬ν„°μ™€ λ§λ²•μ‚¬μ λ
     π“– μ΅°μ•¤ K. λ΅¤λ§
     π― μ μ‚¬λ„: 85.50%

     [π‘ μΆ‹μ•μ] [π‘ λ³„λ΅μ€μ]
```

### 2. ν”Όλ“λ°± μ μ¶

```
User: [π‘ μΆ‹μ•μ] ν΄λ¦­

Bot: β… μ†μ¤‘ν• ν”Όλ“λ°± κ°μ‚¬ν•©λ‹λ‹¤!

     κ²€μƒ‰ ν’μ§ κ°μ„ μ— ν™μ©ν•κ² μµλ‹λ‹¤.
```

### 3. κ΄€λ¦¬μ API

```bash
# ν†µκ³„ μ΅°ν
curl "http://localhost:8080/api/admin/feedback/stats?query=ν•΄λ¦¬ν¬ν„°"

μ‘λ‹µ:
{
  "goodCount": 15,
  "badCount": 2,
  "totalCount": 17,
  "goodRatio": 0.882,
  "feedbackScore": 0.764
}
```

---

## ν•™μµ μ²΄ν¬λ¦¬μ¤νΈ

### ν•„μ κµ¬ν„ μ‚¬ν•­

- [ ] JPA Entity μ„¤κ³„
- [ ] Repository μΈν„°νμ΄μ¤ μ •μ
- [ ] Service μΈν„°νμ΄μ¤ λ° κµ¬ν„
- [ ] DTO μ„¤κ³„
- [ ] Inline Keyboard μƒμ„±
- [ ] Callback Query μ²λ¦¬
- [ ] Bot μ—°λ™
- [ ] Admin API μ„¤κ³„ λ° κµ¬ν„

### λ„μ „ κ³Όμ 

- [x] ν”Όλ“λ°± μ¤‘λ³µ λ°©μ§€
- [x] ν”Όλ“λ°± μµλ…ν™” (PrivacyUtil)
- [x] ν”Όλ“λ°± λ‚΄λ³΄λ‚΄κΈ° (CSV)

---

## νΈλ¬λΈ”μν…

### 1. Inline Keyboardκ°€ ν‘μ‹λμ§€ μ•μ

**μ›μΈ:** `replyMarkup` μ„¤μ • λ„λ½
**ν•΄κ²°:** `SendMessage.builder().replyMarkup(keyboard).build()` ν™•μΈ

### 2. Callback λ°μ΄ν„° νμ‹± μ¤λ¥

**μ›μΈ:** νΉμλ¬Έμ(`:`) μ²λ¦¬ λ―Έν΅
**ν•΄κ²°:** URL μΈμ½”λ”©/λ””μ½”λ”© μ‚¬μ©

### 3. JPA Entity μƒμ„± μ¤λ¥

**μ›μΈ:** κΈ°λ³Έ μƒμ„±μ λ„λ½
**ν•΄κ²°:** `@NoArgsConstructor(access = AccessLevel.PROTECTED)` μ¶”κ°€

### 4. νΈλμ­μ… λ΅¤λ°± λ¬Έμ 

**μ›μΈ:** `@Transactional` λ„λ½
**ν•΄κ²°:** Service λ©”μ„λ“μ— `@Transactional` μ¶”κ°€

---

## Step 5 μ™„λ£

μ΄μ  λ‹¤μ κΈ°λ¥μ΄ μ™„λ£λμ—μµλ‹λ‹¤:

- β… Telegram Bot κΈ°λ³Έ μ„¤μ •
- β… RAG κ²€μƒ‰ μ—°λ™
- β… μ‚¬μ©μ ν”Όλ“λ°± μμ§‘ μ‹μ¤ν…

**μ¶•ν•ν•©λ‹λ‹¤!** AI κΈ°λ° κ²€μƒ‰ μ‹μ¤ν…μ— μ‚¬μ©μ ν”Όλ“λ°± κΈ°λ¥μ„ κµ¬μ¶•ν–μµλ‹λ‹¤.

### ν”Όλ“λ°± μμ§‘μ ν•µμ‹¬

```
μ‚¬μ©μ β†’ κ²€μƒ‰ β†’ κ²°κ³Ό ν™•μΈ β†’ ν”Όλ“λ°±(π‘/π‘) β†’ λ°μ΄ν„° μ €μ¥
   β†‘                                              β†“
   β””β”€β”€β”€β”€β”€β”€β”€β”€ ν†µκ³„ λ¶„μ„, ν’μ§ λ¨λ‹ν„°λ§ β†β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
```

μ΄ ν”Όλ“λ°± μ‹μ¤ν…μ€ λ‹¤μκ³Ό κ°™μ€ κΈ°λ¥μ„ μ κ³µν•©λ‹λ‹¤:

1. **λ°μ΄ν„° μμ§‘**: μ‚¬μ©μ ν”Όλ“λ°±μ„ λ°μ΄ν„°λ² μ΄μ¤μ— μ €μ¥
2. **ν†µκ³„ λ¶„μ„**: κ²€μƒ‰μ–΄λ³„/λ„μ„λ³„ ν”Όλ“λ°± ν†µκ³„ μ κ³µ
3. **ν’μ§ λ¨λ‹ν„°λ§**: κ΄€λ¦¬μ APIλ¥Ό ν†µν•΄ ν”Όλ“λ°± ν„ν™© νμ•…

---

## μ°Έκ³  μλ£

- [Feedback Systems in AI](https://arxiv.org/abs/2201.02142)
- [Telegram Bot API Documentation](https://core.telegram.org/bots/api)
- [Spring Boot REST API Guide](https://spring.io/guides/gs/rest-service/)

---

## λ‹¤μ λ‹¨κ³„

**Step 5 μ™„λ£!** π‰

ν”Όλ“λ°± μμ§‘ μ‹μ¤ν… κµ¬μ¶•μ„ μ™„λ£ν–μµλ‹λ‹¤. λ‹¤μ λ‹¨κ³„λ΅ μ§„ν–‰ν•  μ μμµλ‹λ‹¤:

- **[Step 6: κ°μΈν™” μ¶”μ²](../step-6/)** - ν”Όλ“λ°± λ°μ΄ν„°λ¥Ό ν™μ©ν• μ‚¬μ©μλ³„ λ§μ¶¤ μ¶”μ² μ‹μ¤ν…
- **[Step 7: MCP ν†µν•©](../step-7/)** - Model Context ProtocolμΌλ΅ μ™Έλ¶€ AI μ„λΉ„μ¤ μ—°λ™
