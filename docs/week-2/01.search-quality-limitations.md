# 01. 한계 체감: 키워드 검색의 품질 문제 분석

## 학습 전제조건

이 문서를 학습하기 전에 다음 내용을 알고 있으면 도움이 됩니다:
- Week 1의 LIKE 검색과 전문 검색 이해
- 데이터베이스 인덱스 기초
- 검색 엔진 사용 경험

---

## 1. 개요

Week 1에서 만든 검색 시스템이 실제로는 얼마나 잘 작동할까요?

**이 문서에서 배울 내용:**
- 키워드 검색의 실제 한계 경험하기
- 왜 벡터 검색이 필요한지 이해하기
- 검색 품질을 측정하는 방법 배우기
- 의미 기반 검색(Semantic Search)의 필요성

> **중요: 왜 이 내용을 배워야 할까요?**
>
> 실제 사용자는 정확한 키워드를 입력하지 않습니다.
>
> - "컴퓨터 구조" 대신 "Computer Architecture"를 찾을 수도 있어요
> - "자바" 대신 "좌바"라고 오타를 낼 수도 있어요
> - "가벼운 노트북"으로 검색하면 휴대성 좋은 노트북을 원하는 걸까요?
>
> 이런 문제를 어떻게 해결할까요?

---

## 2. 키워드 검색의 한계

### 2.1. 동의어 처리 불가

**문제:** 글자가 다르면 같은 의미라도 찾을 수 없습니다.

**예시:**
```
사용자 검색: "컴퓨터 구조"
책 제목: "Computer Architecture"

결과: 0건 찾음

사용자가 원하는 것: 컴퓨터 구조에 관한 책
시스템이 찾는 것: "컴퓨터 구조"라는 글자
```

**비유로 이해하기:**
```
외국인 친구에게 "apple"을 찾아달라고 부탁했는데,
한글로 "사과"라고 써진 책은 못 찾는 것과 같습니다.

시스템은 "apple"과 "사과"가 같은 의미라는 걸 몰라요.
```

### 2.2. 오타 및 형태 변화에 취약

**문제:** 글자가 조금만 달라도 검색이 안 됩니다.

**예시:**
```
정확한 입력: "자바 프로그래밍"
검색 결과: 100권 찾음

오타 입력: "좌바 프로그래밍"
검색 결과: 0권 찾음

형태 변화: "자바 프로그램"
검색 결과: 0권 찾음
```

**비유로 이해하기:**
```
도서관 사서가 매우 꼼꼼해요.

- "자바의 정석" → 찾아줌
- "자바의 정석!!" (느낌표 2개) → 못 찾아요
- "자바의 정석 " (뒤에 공백) → 못 찾아요

똑같은 책인데, 표현만 조금 달라져도 못 찾는 경우가 많아요.
```

### 2.3. 의미 파악 불가

**문제:** 단어의 의미가 아니라 글자 매칭만 합니다.

**예시:**
```
사용자 검색: "가벼운 노트북"

시스템 결과:
1. "가벼운 노트북을 찾아서" (정확!)
2. "가벼운 노트북 추천" (좋음!)
3. "가벼운 노트북으로 일하기" (관련 있음)

사용자가 원하는 것:
→ "휴대성이 좋은 노트북" (의미)
→ "배터리 오래가는 노트북" (의미)

시스템이 찾는 것:
→ "가벼운" + "노트북" 글자가 있는지 (패턴)
```

**비유로 이해하기:**
```
초등학생이 "동물"에 대해 물어봐요.

키워드 검색:
- "동물"이라는 단어가 들어간 문서만 찾아요
- "강아지", "고양이"는 동물인데도 못 찾을 수 있어요
- "반려동물"이라고 써도 못 찾을 수 있어요

의미 검색:
- 강아지, 고양이, 반려동물을 모두 찾을 수 있어요
- "동물"이라는 단어가 없어도 의미가 비슷하면 찾아요
```

### 2.4. 전부 아니면 전무

**문제:** 키워드가 없으면 결과가 0건입니다.

**예시:**
```
책장에 100권의 자바 책이 있어요.

검색: "자바 언어"
결과: 50권 찾음

검색: "자바 프로그래밍 언어"
결과: 10권 찾음

검색: "Java Programming Language"
결과: 0권 찾음

사용자: "책이 없나요?" 하고 이탈
```

---

## 3. 전문 검색의 한계도 있어요

Week 1에서 배운 전문 검색(Full Text Search)도 **의미** 문제는 해결하지 못해요.

**전문 검색이 하는 일:**
- 문장을 단어로 쪼개기 (토큰화)
- 단어별로 색인 만들기 (역색인)
- 단어가 포함된 문서 찾기

**전문 검색이 못 하는 일:**
- "컴퓨터"와 "Computer"가 같은 의미인지 모름
- "좌바"가 "자바"의 오타인지 모름
- "가벼운 노트북"의 의도를 이해하지 못함

**비유로 이해하기:**
```
전문 검색은 책 뒤의 '찾아보기'와 같아요.

[책 뒤의 색인]
- 행복: 페이지 1, 5, 10, 15
- 슬픔: 페이지 2, 8, 20
- ...

"기쁨"이라는 단어를 찾고 싶어요.

전문 검색:
- "기쁨"이 있나요? → 없으면 못 찾아요
- "기쁨"과 비슷한 "즐거움"은 못 찾아요

의미 검색:
- "기쁨"과 비슷한 "즐거움"도 찾을 수 있어요
```

---

## 4. 해결책: 벡터 검색(Vector Search)

### 4.1. 임베딩(Embedding)이란?

**임베딩**은 단어나 문장을 숫자로 변환하는 기술입니다.

**비유로 이해하기:**
```
세상 모든 것을 좌표로 표현할 수 있어요.

[위치]
- 집: (x: 10, y: 20)
- 회사: (x: 15, y: 25)
- 카페: (x: 12, y: 22)

[색깔]
- 빨강: (R: 255, G: 0, B: 0)
- 파랑: (R: 0, G: 0, B: 255)
- 초록: (R: 0, G: 255, B: 0)

[단어의 의미]
- 왕: (0.8, 0.2, 0.9, ...)
- 왕비: (0.7, 0.3, 0.8, ...) ← 왕이랑 가까움!
- 사과: (0.1, 0.9, 0.2, ...)
- 배: (0.1, 0.8, 0.3, ...) ← 사과랑 가까움!
```

### 4.2. 벡터 공간에서의 유사도

**벡터 공간**에서는 의미가 비슷한 단어들이 가까이 위치합니다.

**예시:**
```
[2차원 벡터 공간]

        과일
         ↑
    배  ●  사과
         ●
    ───────┼──────→
    야채  ●  고기

"사과"와 "배"는 가깝게 있어요 (같은 과일)
"고기"와 "야채"는 멀리 떨어져 있어요
```

**실제 벡터 예시:**
```
"자바"라는 단어를 3차원 벡터로 표현

자바: [0.8, 0.3, -0.2]
프로그래밍: [0.7, 0.5, -0.1]
Python: [-0.3, 0.8, 0.2]
커피: [0.1, 0.2, 0.9]

"자바"와 "프로그래밍"은 가깝게 있어요 → 유사함 ✅
"자바"와 "커피"는 멀리 떨어져 있어요 → 다름
```

### 4.3. 벡터 검색의 장점

| 특징 | 키워드 검색 | 벡터 검색 |
|------|-------------|-----------|
| 정확한 일치 | 가능 | 불가능 |
| 동의어 처리 | 불가능 | 가능 |
| 오타 허용 | 불가능 | 가능 |
| 의미 기반 검색 | 불가능 | 가능 |
| 검색 속도 | 빠름 | 느림 |
| 구현 난이도 | 쉬움 | 어려움 |

---

## 5. 검색 품질 측정하기

### 5.1. 정밀도(Precision)와 재현율(Recall)

**정밀도:** 검색 결과 중 얼마나 관련 있는 것인지
```
10개를 검색했는데 8개가 진짜 내가 찾던 거
정밀도 = 8 / 10 = 80%
```

**재현율:** 전체 관련 문서 중 얼마나 찾았는지
```
도서관에 내가 찾는 책이 10권 있는데 5권만 찾음
재현율 = 5 / 10 = 50%
```

**비유로 이해하기:**
```
그물을 던질 때를 상상해 보세요.

정밀도 (Precision):
- 그물에 걸린 물고기 중 진짜 먹을 수 있는 물고기 비율
- "정확도"라고도 불러요
- 높으면 좋음: 쓰레기가 안 잡혔다는 뜻

재현율 (Recall):
- 바다에 있는 물고기 중 그물에 걸린 비율
- "누락률"의 반대
- 높으면 좋음: 물고기를 놓치지 않았다는 뜻
```

### 5.2. 검색 관련성(Search Relevance)

검색 결과를 어떤 순서로 보여줄지 결정하는 방법입니다.

**BM25 알고리즘:**
- 단어가 문서에 얼마나 자주 나오는지 계산
- 문서의 길이도 고려
- 가장 관련 있는 문서가 위로 오도록 정렬

**비유로 이해하기:**
```
시험 채점과 비슷해요.

[시험 문제: "자바 프로그래밍 설명"]

답안 A:
"자바는 객체 지향 프로그래밍 언어입니다..."
→ "자바" 3번, "프로그래밍" 2번 언급
→ 점수: 95점

답안 B:
"프로그래밍은 컴퓨터로 하는 것입니다..."
→ "프로그래밍" 1번 언급
→ 점수: 30점

답안 A를 먼저 보여주겠죠?
```

---

## 6. 실습 미션

### 미션 1: 키워드 검색 한계 경험하기

실제 검색 엔진에서 다음 검색을 해보세요:

1. "컴퓨터 구조" 검색
2. "computer architecture" 검색
3. 결과를 비교해 보세요

### 미션 2: 동의어 문제 확인하기

다음 검색어들의 결과를 확인해 보세요:

1. "스마트폰" vs "핸드폰"
2. "노트북" vs "랩탑"
3. "자동차" vs "차"

### 미션 3: 오타 허용 실험

일부러 오타를 내서 검색해 보세요:

1. "자바" → "자바" (띄어쓰기)
2. "프로그래밍" → "프로그래밍" (받침 추가)
3. 검색 결과가 어떻게 달라지는지 확인해 보세요

---

## 7. 학습 체크리스트

다음 내용을 이해했는지 확인해 보세요:

- [ ] 키워드 검색의 한계를 설명할 수 있다
- [ ] 동의어 처리 문제를 이해한다
- [ ] 오타에 취약한 이유를 안다
- [ ] 의미 파악의 중요성을 안다
- [ ] 정밀도와 재현율 차이를 설명할 수 있다
- [ ] 임베딩(Embedding)의 개념을 이해한다
- [ ] 벡터 검색이 왜 필요한지 설명할 수 있다

---

## 8. 다음 단계

다음 문서에서는 **벡터 검색을 위한 준비**를 합니다:
- pgvector 확장 설치
- 벡터 컬럼 추가하기
- 데이터베이스 벡터 검색 이해하기

[다음: 02. pgvector 설정 →](02.add-pgvector-column.md)
