# 03. 지식 수치화: AI 임베딩(Embedding) 생성 Batch

Week 2의 세 번째 단계로, 도서 데이터를 AI가 이해할 수 있는 숫자의 나열(Vector)로 변환하는 **임베딩(Embedding)** 생성 프로세스를 학습합니다.

## 1. 개요

데이터베이스에 벡터를 담을 그릇(`embedding` 컬럼)을 만들었다면, 이제 그 그릇을 채울 내용을 만들어야 합니다. 이 과정은 도서의 텍스트 정보(제목, 내용 등)를 AI 모델에 전달하여 고차원 벡터로 변환받는 과정입니다. 대량의 도서를 처리해야 하므로, Week 1에서 배웠던 **Batch** 방식을 다시 활용하여 효율적으로 처리합니다.

## 2. 주요 개념

### 2.1. 임베딩(Embedding)
단어나 문장의 '의미'를 컴퓨터가 계산할 수 있는 좌표(Vector)로 변환하는 기술입니다.
- 단순히 글자 모양을 보는 것이 아니라, 그 안에 담긴 '뜻'을 수치화합니다.
- **예시**: "사과" → `[0.1, 0.2, ...]` / "배" → `[0.11, 0.19, ...]` (두 숫자가 비슷함)

### 2.2. 임베딩 모델 (Embedding Model)
텍스트를 입력받아 벡터를 출력해주는 AI 모델입니다.
- 주로 외부 API(OpenAI 등)나 로컬 라이브러리(Spring AI, LangChain4j 등)를 통해 사용합니다.
- 모델마다 출력되는 벡터의 크기(Dimension)가 다르므로, DB 설정과 일치시켜야 합니다.

## 3. 구현 가이드 (Step-by-Step)

### 3.1. 외부 AI API 연동 설정
AI 모델을 호출하기 위한 API 키와 엔드포인트를 설정합니다.
```properties
# application.properties 예시
ai.embedding.api-key=YOUR_API_KEY
ai.embedding.model=text-embedding-3-small
```

### 3.2. 임베딩 생성 서비스 구현
텍스트를 받아 AI 모델을 호출하고 벡터를 반환받는 서비스를 작성합니다.
- **Spring AI**와 같은 프레임워크를 사용하면 편리하게 구현할 수 있습니다.

### 3.3. 배치 처리 로직 고도화
Week 1의 `BookBatchService`와 유사한 방식으로, DB에 저장된 도서들을 일정 단위로 읽어와 임베딩을 생성하고 다시 저장합니다.
1. 임베딩이 없는 도서들을 조회합니다.
2. 도서의 제목과 본문을 합쳐 임베딩용 텍스트를 만듭니다.
3. AI API를 호출하여 벡터를 생성합니다.
4. 생성된 벡터를 `embedding` 컬럼에 업데이트합니다.

## 4. 학습 포인트

*   **텍스트의 수치화**: 인간의 언어가 어떻게 AI를 위한 데이터로 변환되는지 원리를 이해합니다.
*   **API 비용과 속도**: 외부 AI 서비스를 대량으로 호출할 때 발생하는 비용 문제와 네트워크 지연을 줄이기 위한 배치 전략을 학습합니다.
*   **데이터 정제(Cleaning)**: AI 모델에 넣기 전, 텍스트에서 불필요한 특수문자나 공백을 제거하는 전처리 과정의 중요성을 이해합니다.

## 5. 심화 학습 (Study Topics)

AI의 번역기, 임베딩에 대해 쉽게 알아봅시다.

### 5.1. AI 전용 번역기 (Embedding)
영어를 한국어로 번역하듯, 임베딩은 **'인간의 언어'를 'AI의 언어(숫자)'로 번역**하는 과정입니다.
- **비유**: 전 세계 사람들이 각기 다른 언어로 "사랑해"라고 말해도, 그 '의미'는 하나인 것처럼, AI는 모든 단어를 공통된 '의미 지도' 위의 좌표로 변환합니다.

### 5.2. 지식의 압축
수만 글자의 도서 내용을 수천 개의 숫자로 압축하는 과정입니다.
- **비유**: 두꺼운 백과사전의 핵심 내용을 짧은 요약문으로 만드는 것과 비슷합니다. 요약문(벡터)만 보고도 그 책이 어떤 주제인지 AI는 판단할 수 있습니다.

## 6. 참고 링크

*   [Spring AI Embedding API](https://docs.spring.io/spring-ai/reference/api/embeddings.html)
*   [LangChain4j Embedding Guide](https://docs.langchain4j.dev/tutorials/embeddings)
*   [OpenAI Embeddings Documentation](https://platform.openai.com/docs/guides/embeddings)
